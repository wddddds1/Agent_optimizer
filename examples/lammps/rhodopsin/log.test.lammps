LAMMPS (10 Dec 2025 - Development - patch_10Dec2025-121-gd51f1eef21)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
# Rhodopsin protein in membrane - large biomolecular system
# 瓶颈: kspace (PPPM 长程静电) + pair (lj/charmm/coul/long)
# 特点: 真实生物分子系统, bond/angle/dihedral 计算

units           real
neigh_modify    delay 5 every 1

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
pair_style      lj/charmm/coul/long 8.0 10.0
pair_modify     mix arithmetic
kspace_style    pppm 1e-4

read_data       ../../third_party/lammps/bench/data.rhodo
Reading data file ...
  orthogonal box = (-27.5 -38.5 -36.3646) to (27.5 38.5 36.3615)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  32000 atoms
  reading velocities ...
  32000 velocities
  scanning bonds ...
  4 = max bonds/atom
  scanning angles ...
  8 = max angles/atom
  scanning dihedrals ...
  18 = max dihedrals/atom
  scanning impropers ...
  2 = max impropers/atom
  orthogonal box = (-27.5 -38.5 -36.3646) to (27.5 38.5 36.3615)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  27723 bonds
  reading angles ...
  40467 angles
  reading dihedrals ...
  56829 dihedrals
  reading impropers ...
  1034 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     4 = max # of 1-2 neighbors
    12 = max # of 1-3 neighbors
    24 = max # of 1-4 neighbors
    26 = max # of special neighbors
  special bonds CPU = 0.005 seconds
  read_data CPU = 0.302 seconds

fix             1 all shake 0.0001 5 0 m 1.0 a 232
Finding SHAKE clusters ...
    1617 = # of size 2 clusters
    3633 = # of size 3 clusters
     747 = # of size 4 clusters
    4233 = # of frozen angles
  find clusters CPU = 0.003 seconds
fix             2 all npt temp 300.0 300.0 100.0                 z 0.0 0.0 1000.0 mtk no pchain 0 tchain 1

special_bonds   charmm

thermo          100
thermo_style    custom step temp pe ke etotal press vol
timestep        2.0

# 500 步, 预计运行 30-60 秒
run             500
PPPM initialization ...
  using 12-bit tables for long-range coulomb
  G vector (1/distance) = 0.24883488
  grid = 25 32 32
  stencil order = 5
  estimated absolute RMS force accuracy = 0.035547797
  estimated relative force accuracy = 0.00010705113
  using double precision FFTW3
  3d grid and FFT values/proc = 41070 25600
Generated 2278 of 2278 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 5 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 10 13 13
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmm/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 140 | 140 | 140 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume    
         0   299.03967     -46801.037      21444.831     -25356.206     -149.33         307995.03    
       100   301.09061     -46882.645      21591.909     -25290.736      6.7352002      308134.23    
       200   300.80411     -46650.204      21571.363     -25078.841      20.675971      308997.56    
       300   299.78092     -46497.233      21497.987     -24999.245     -370.8262       309663.82    
       400   298.67729     -46619.696      21418.844     -25200.852      251.78211      309816.14    
       500   302.03391     -46626.077      21659.555     -24966.523     -310.21446      309767.58    
Loop time of 65.6443 on 1 procs for 500 steps with 32000 atoms

Performance: 1.316 ns/day, 18.235 hours/ns, 7.617 timesteps/s, 243.738 katom-step/s
99.8% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.154     | 49.154     | 49.154     |   0.0 | 74.88
Bond    | 1.3064     | 1.3064     | 1.3064     |   0.0 |  1.99
Kspace  | 3.5013     | 3.5013     | 3.5013     |   0.0 |  5.33
Neigh   | 10.596     | 10.596     | 10.596     |   0.0 | 16.14
Comm    | 0.079498   | 0.079498   | 0.079498   |   0.0 |  0.12
Output  | 0.00020687 | 0.00020687 | 0.00020687 |   0.0 |  0.00
Modify  | 0.99262    | 0.99262    | 0.99262    |   0.0 |  1.51
Other   |            | 0.01474    |            |       |  0.02

Nlocal:          32000 ave       32000 max       32000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          47917 ave       47917 max       47917 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1.19617e+07 ave 1.19617e+07 max 1.19617e+07 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11961657
Ave neighs/atom = 373.80178
Ave special neighs/atom = 7.431875
Neighbor list builds = 55
Dangerous builds = 0
Total wall time: 0:01:06
