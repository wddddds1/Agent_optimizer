# Rhodopsin protein in membrane - large biomolecular system
# 瓶颈: kspace (PPPM 长程静电) + pair (lj/charmm/coul/long)
# 特点: 真实生物分子系统, bond/angle/dihedral 计算

units           real
neigh_modify    delay 5 every 1

atom_style      full
bond_style      harmonic
angle_style     charmm
dihedral_style  charmm
improper_style  harmonic
pair_style      lj/charmm/coul/long 8.0 10.0
pair_modify     mix arithmetic
kspace_style    pppm 1e-4

read_data       ../../third_party/lammps/bench/data.rhodo

fix             1 all shake 0.0001 5 0 m 1.0 a 232
fix             2 all npt temp 300.0 300.0 100.0 &
                z 0.0 0.0 1000.0 mtk no pchain 0 tchain 1

special_bonds   charmm

thermo          100
thermo_style    custom step temp pe ke etotal press vol
timestep        2.0

# 500 步, 预计运行 30-60 秒
run             500
